title: 关于Vim一些不常用的36个小技巧
date: 2015-01-30 07:56:43
tags: [Vim]
---
无聊通读了一遍Vim用户手册，摘取出了一些不常用但是很方便的小技巧，记录在此。

1. 删除换行符，命令是”J”。

2. 像”w”有一个反方向的命令”b”一样，”e”的反方向命令是”ge”，它将光标移到前一个word的最后一个字符上。

3. "$"命令还可接受一个计数，就象其它的移动命令一样。但是移动到一行的行尾多于一次没有任何意义。所以它的功能被赋予为移动到下一行的行尾。如"1$"会将光标移动到当前行行尾，"2$"则会移动到下一行的行尾，如此类推。

4. "tx"命令形同"fx”命令，只不过它不是把光标停留在被搜索字符上，而是在它之前的一个字符上。提示："t"意为"To"。该命令的反方向版是”Tx"。

5. "H"意为Home, "M"为Middle, "L”为Last，可以移动到目前显示在屏幕上的第一行、中间那行和最后一行。

6. CTRL-U命令会使文本向下滚动半屏，也可以想象为在显示文本的窗口向上滚动了半屏。CTRL-D命令将窗口向下移动半屏，所以相当于文本向上滚动了半屏。要一次滚动一行可以使用CTRL-E(向上滚动)和CTRL-Y(向下滚动)。 提示:CTRL-E 意为Extra。要向前滚动一整屏(实际上是整屏去两行)使用命令CTRL-F，另外CTRL-B是它的反向版。很幸运CTRL-F是向前1，CTRL-B是向后2，好记吧！一个经常遇到的问题是你用"j"命令向下移动了若干行后当前光标已经处于屏幕的底端了。而你又想查看当前行前后的几行内容。"zz"命令会把当前行置为屏幕正中央，"zt"命令会把当前行置于屏幕顶端，"zb"则把当前行置于屏幕底端。

7. 把光标定位于这个word上，然后按下“*”键。Vim将会取当前光标所在的word并将它作用目标字符串进行搜索。"#"命令是"*"的反向版。还可以在这两个命令前加一个命令计数："3*"查找当前光标下的word的第三次出现。

8. "\\>\"是一个特殊的记法，它只匹配一个word的结束处。近似地，"\\<\"匹 配到一个word的开始处。这样查找作为一个word的"the"就可以用:\\<the\\>，这个命令就不会匹配到"there"或”soothe"。

9. ^字符匹配一行的开头。象"include"这样的模式可以匹配出现在一行中任何位置的include这个单词。但是模式"^include"就只匹配出现在一行开头的include，$字符匹配一行的末尾，所以"was$"只匹配位于一行末尾的单词was。

10. 当你用"G”命令（包括"/"和"n"这些搜索命令，但是字符搜索命令"fx"和”tx"，或者是以word为单位的移动光标位置的命令"w"和"e"不叫跳转。同时，"j"和"k"命令并不被视为一个跳转，即使你在它们之前加了命令计数让当前光标跳到老远的地方也是如此）从一个地方跳转到另一个地方时，Vim会记得你起跳的位置。这个位置在Vim中是一个标记。使用\`\`命令可以使你跳回到你刚才的出发点，再次使用上面的这个命令你就会又跳回来了。这是因为\`也是一个跳 转命令，所以上次跳转时的起跳位置现在被标记为了`。CTRL-O命令是跳转到你更早些时间停置光标的位置(提示:O意为older)， CTRL-I则是跳回到后来停置光标的更新的位置(提示:I在键盘上位于O前面)。

11. Vim允许你在文本中定义你自己的标记。命令"ma"将当前光标下的位置名之为标记"a"。从a到z一共可以使用26个自定义的标记。定义后的标记在屏幕上也看不出来。不过Vim在内部记录了它们所代表的位置。要跳转到一个你定义过的标记，使用命令\`{mark}，{mark}就是你定义的标记的名字。就象\`a。命令'mark(单引号，或者叫呼应单引号)会使你跳转到mark所在行的行首。这与\`mark略有不同，`mark会精准地把你带到你定义mark时所在的行和列。标记对于编辑那些有两块内容相互关联的文件十分有用。想象一下你在文件开头有一段文字需要时时参考，但实际上要修改编辑的地方却在文件结尾处的情形。

12. 就象"dd"命令可以删除整行一样，"cc"命令可以改变整行。不过仍保持原来的缩进(一行打头的空白)，也正如"d$"删除到行尾为止的内容，"c$"改变当前光标到行尾的内容。就好象是用"d$"删除然后又以"a"进入Insert模式追加新的文本一样。

13. 有一些操作符+位移命令使用率是如此之高以至于它们以一个单独的字符作为其快捷方式：x代表dl(删除当前光标下的字符)，X代表dh(删除当前光标左边的字符)，D代表d$(删除到行尾的内容)，C 代表c$(修改到行尾的内容)，s代表cl(修改一个字符)，S 代表cc(修改一整行)。

14. 要把一个字符替换为一个换行符使用"r<Enter>"。它会删除一个字符并插入一个换行符。但在此处使用命令记数只会删除指定个数的字符:"4r&lt;Enter&gt;"将把4个字符替换为一个换行符。

15. "."命令是Vim中一个简单而强大的命令。它会重复上一次做出的改动。例如，假设你在编辑一个HTML文件，想删除其中所有的&lt;B&gt;标签。你把光标置于&lt;B&gt;的&lt;字符上然后命令"df&gt;"。然后到&lt;/B&gt;的&lt;上用"."命令做同样的事。"."命令会执行上一次所执行的更改命令(此例中是"df&gt;\")。 要删除另一个标签，同样把光标置于&lt;字符上然后执行"."命令即可。

16. 如果你想整行整行地操纵文本，使用"V"进入Visual模式。你会看到被选中的文本是是一整行一整行为单位。命令左右移动命令毫无意义。而上下位移命令则会整行整行地选择文本。如果你想以一个矩形的文本块为对象进行操作，你需要用CTRL-V进入Visual模式。在编辑表格时这可就派上用场了。

17. 如果你已经在Visual模式下选中了一些文本，但此时发现还要改变另一头的被选择区域，"o"命令(提示:o代表other end另一头)会让光标置于被选中文本的另一头，这样你就可以通过控制光标移动来决定被选文本将从何处开始。再按"o"又会让光标置于被选文本的末端。当你进行矩形文本块内容的选择时，你有4个角都可以改变。"o"只会把你带到对角的位置去，使用"O"命令可以让你在同一行的左右两个角之间移动 。注意"o"和"O"在Visual模式与Normal模式下行为迥异，在Normal模式下它们是在当前行的下面或上面插入一个新行。

18. "P"命令与"p"一样取回被删除的内容，不过它把被取回的内容置于光标之前。对于以"dd"删除的整行内容，"P"会把它置于当前行的上一行。对于以"dw"删除的部分内容，"P"会把它放回到光标之前。你可以多次取回被删除的内容。其内容取之不竭。也可以对命令"p"和"P"命令使用命令记数。它的效果是同样的内容被取回指定的次数。这样一来"dd"之后的"3p"就可以把被删除行的3份副本放到当前位置。

19. 输入文本的时候，人们常常会发现手比脑跑得要快(或者脑比手跑得快)。不管谁更快结果都是拼错字，比如把"the"拼成"teh"。在Vim中改正此类错误十分容易，把光标置于"teh"的e上执行命令"xp"。它的工作如下:"x"删除字符e并把它放入一个寄存器中。"p"命令把被删除的e再放回到当前光标之后，也就是h后面。

20. 把一行内容复制到剪贴板:"*yy，要把剪贴板的内容复制过来:”*p。

21. "daw"中的"d"还是操作符命令。"aw"是一个文本对象。提示:"aw"意为"A Word"。这样"daw"的完整意思是"Delete A Word”，更准确地说，该Word之后的空白字符也被删除了(即位于行末尾的单词之前的空白)。

22. "cis"由操作符"c"和文本对象"is"组成。它是"Inner Sentence"的缩写。相应地还有一个叫"as"(a sentence)的。如果你想删除一个句子, 你会希望把它后面的空白也给删除，所以此时最好用”das"。如果你是想以新的文本替代它，空白就可以留下来，使用"cis"好了。你也可以在Visual模式使用文本对象。它将把指定的文本对象选 进Visual模式的文本选择区域中。当前模式仍是Visual模式，所以你可以多次使用该命令。例如，以"v"开始Visual模式，以"as"选取一个句子。 现在你可以重复使用"as"来包括进更多的句子。最后你可以用一个操作符命令来作用于最终被选中的范围。

23. 通常情况下Vim不会生成备份文件。如果你需要的话，只需要执行命令:":set backup"。生成的备份文件名将是原文件名后面附加一个~。如果原文件是data.txt，则生成的备份文件是data.txt~。如果你不喜欢这个默认的备份文件名后辍，你可以用下面的命令重新指定一个:":set backupext=.bak"。这将会生成一个名为data.txt.bak的备份文件。

24. 要把多行文本收集到一起写入一个文件，可以用:write &gt;&gt; logfile命令。这将会把当前文件的内容追加到文件"logfile"。这样做避免了你使用前面的方法去复制内容，编辑log文件。这样可以省去两个环节。但它的局限是只能在文件的最后追加内容。要想只追加几行的内容到文件中去，可以在使用命令":write"之前先在Visual模式下选定要写入的内容。

25. 命令vim -R file以只读方式运行Vim，如果你改动了该文件但忘了它是只读的，你还是可以保存该文件。在":write"命令之后使用!强制执行修饰符。如果是想强制性地避免对文件进行修改，可以用命令vim -M file，这样每个修改文件的尝试都会失败。帮助文件就是这样。:set modifiable，:set write命令还是可以去掉这层保护。

26. "."命令可以重复最近一次的编辑动作。但是如果你要做的操作远比这些小儿科复杂呢？那就是Vim为什么要引入命令记录的原因。使用命令记录分三个步骤：1、使 用"q{register}"命令开始，后续的动作将被记录进名为{register}的寄存器中。给出的寄存器名字必需是a到z之间的一个字母。2、执行你要执行的操作。3、按下q以结束对命令的记录(注意仅仅是q一个字符，不要键入多余的字符)。现在你可以通过"@{recording}"命令来执行刚刚记录下来的记录宏了。对其它要执行3次"@"命令，"@"命令也可以加一个数字前辍如：3@a。

27. 也许实际情况是你在几个不同的地方要执行这些操作(而不象上例中是连续的4行)。这只需要你将光标定位到目标行，然后再执行"@a"命令。如果已经执行过"@a”命令，下次重复执行只需再下"@@"即可。这比"@a"更容易键入。同样，如果你上次执行的是"@b"那么"@@"命令也将重复"@b"的动作。与".”方法相比，记录回放有几个地方不同，首先，"."命令只能重复一个动作。而在上例中，"@a"重复的是好几个命令，其次，"."命令只重复最近一次改动的命令。而执行一个记录宏允许你随时都可执行同样的操作。最后，你拥有多达26个寄存器可供使用。也就是说，可以同时保存26个不同的命令宏。

28. 目前为止我们用到的还都是小写字母的寄存器。要向寄存器追加内容而不是覆盖它，使用它的大写形式即可。假设你已经记录了一个改变word的命令在寄存器c中。它已经可以正常工作，但你又想让它搜索到下一个word继续编辑。可以使用下面的命令qC/word&lt;Enter&gt;q。以"qC”命令开始，这使得被记录的命令将被追加到寄存器c中，而不是覆盖它当前的内容。这种方式对命令记录和一般的yank，删除操作都有效。比如你要把几行的内容收集到一个寄存器中去，以小写来yank第一行"aY，现在移动到第二行，执行"AY，对你要收集的行重复执行这个操作。现在寄存器a就会包括所有这些 行的内容。

29. :.,$s/yes/no/命令替换当前行到最后一行中所有的yes为no。

30. 命令"Istring&lt;Esc&gt;"会在每行中插入相同的文本，插入位置在被选择块的左边。具体过程是以CTRL-V进入Visual block模式。然后移动光标来调整被选择的区域。接下来键入I命令进入插入模式，键入你要插入的文本。在你键入文本的过程中，被键入的内容只会同时显示在文本块的第一行中。一旦你按下&lt;Esc&gt;来结束插入，刚刚键入的内容就会奇迹般地出现在被选择文本块的每一行中。"A"命令类似于”I"，只不过它是在文本块的最右边追加文本。

31. Visual block模式下的"c"命令会删除被选择的文本块，然后你会身处Insert模式，键入改变后的内容。"C"命令会删除文本块最左边至每一行末尾的所有内容。"r"将使整个文本块的内容全部以一个字符来填充。

32. Visual block模式下还有其它一些改变文本内容的命令：~交换大小写 (a -&gt; A, A -&gt; a)、U将小写变大写 (a-&gt;A,A-&gt;A)、u将大写变小写 (a-&gt;a,A-&gt;a)。

33. Visual block模式下"&gt;"命令会使你的文本块向右移动一个"shift 单位”，空出来的部分放置以空格。被移动的区域始自文本块左边界。移动的多寡由选项'shiftwidth'指定。欲使之移动4个空格:set shiftwidth=4。"&lt;"命令使文本块向左移动一个"shift单位"。不过它不象"&gt;"一样姿意，它受限于文本块左边的空间，所以如果文本块左边的空白区域短于一个"shift单位”，它也无能为力。

34. gqap命令告诉Vim格式化你的当前文本段。该命令以\"gq”开始，这是Vim中的一个操作符。接下来是”ap"，它代表"a paragraph"这样一个文本对象，文本段与文本段之间的分隔标志是一个空行。gggqG命令来格式化整个文件。"gg"会首先定位到第一行，然后"gq"告诉Vim要格式文本了，"G"移动 操作符跳转到最后一行，连起来的意思就是格式化整个文件。

35. 你可能只想替换那些出现在注释中的”four"，代码中的留下。"c"标志可以让每个目标被替换之前询问你的意见:%s/&lt;four&gt;/4/gc。

36. 键入命令'0你就会准确地回到你上次退出时的位置。每次退出Vim时它都会创建一个特殊的标记。最后的一个是'0。上次的'0现在会变成’1，原来的'1成了’2，如此类推，原来的'9就丢掉了。|:marks|命令可用来找出这些从'0到'9的标记都指向哪里。